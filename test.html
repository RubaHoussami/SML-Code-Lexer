<html>
<body><tt>
<span style="color:#00aaff;">(* Exercise 1 *)</span><br>
<br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>is_older</span>&nbsp;<span style="color:#0000ff;">(</span><span>date1</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">,</span>&nbsp;<span>date2</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">(</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span>date1</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;"><</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span>date2</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#a0a000;">orelse</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span>date1</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span>date2</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#a0a000;">andalso</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#0000ff;">#</span><span style="color:#ff0000;">2</span>&nbsp;<span>date1</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;"><</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#0000ff;">#</span><span style="color:#ff0000;">2</span>&nbsp;<span>date2</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#a0a000;">orelse</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span>date1</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span>date2</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#a0a000;">andalso</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#0000ff;">#</span><span style="color:#ff0000;">2</span>&nbsp;<span>date1</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#0000ff;">#</span><span style="color:#ff0000;">2</span>&nbsp;<span>date2</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#a0a000;">andalso</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#0000ff;">#</span><span style="color:#ff0000;">1</span>&nbsp;<span>date1</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;"><</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#0000ff;">#</span><span style="color:#ff0000;">1</span>&nbsp;<span>date2</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>number_in_month</span>&nbsp;<span style="color:#0000ff;">(</span><span>list_of_dates</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span>list</span><span style="color:#0000ff;">,</span>&nbsp;<span>month</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>null</span>&nbsp;<span>list_of_dates</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#ff0000;">0</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">2</span>&nbsp;<span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>list_of_dates</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>month</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#ff0000;">1</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span>number_in_month</span><span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>list_of_dates</span><span style="color:#0000ff;">,</span>&nbsp;<span>month</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>number_in_month</span><span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>list_of_dates</span><span style="color:#0000ff;">,</span>&nbsp;<span>month</span><span style="color:#0000ff;">)</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>number_in_months</span>&nbsp;<span style="color:#0000ff;">(</span><span>list_of_dates</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span>list</span><span style="color:#0000ff;">,</span>&nbsp;<span>list_of_months</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span>&nbsp;<span>list</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>null</span>&nbsp;<span>list_of_months</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#ff0000;">0</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>number_in_month</span><span style="color:#0000ff;">(</span><span>list_of_dates</span><span style="color:#0000ff;">,</span>&nbsp;<span>hd</span>&nbsp;<span>list_of_months</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span>number_in_months</span><span style="color:#0000ff;">(</span><span>list_of_dates</span><span style="color:#0000ff;">,</span>&nbsp;<span>tl</span>&nbsp;<span>list_of_months</span><span style="color:#0000ff;">)</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>dates_in_month</span>&nbsp;<span style="color:#0000ff;">(</span><span>list_of_dates</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span>list</span><span style="color:#0000ff;">,</span>&nbsp;<span>month</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>null</span>&nbsp;<span>list_of_dates</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#0000ff;">[</span><span style="color:#0000ff;">]</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">2</span>&nbsp;<span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>list_of_dates</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>month</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span>hd</span>&nbsp;<span>list_of_dates</span>&nbsp;<span style="color:#0000ff;">::</span>&nbsp;<span>dates_in_month</span><span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>list_of_dates</span><span style="color:#0000ff;">,</span>&nbsp;<span>month</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>dates_in_month</span><span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>list_of_dates</span><span style="color:#0000ff;">,</span>&nbsp;<span>month</span><span style="color:#0000ff;">)</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>get_nth</span>&nbsp;<span style="color:#0000ff;">(</span><span>list_of_strings</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">string</span>&nbsp;<span>list</span><span style="color:#0000ff;">,</span>&nbsp;<span>n</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>n</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span style="color:#ff0000;">1</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span>hd</span>&nbsp;<span>list_of_strings</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>get_nth</span><span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>list_of_strings</span><span style="color:#0000ff;">,</span>&nbsp;<span>n</span><span style="color:#ff0000;">-1</span><span style="color:#0000ff;">)</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>date_to_string</span>&nbsp;<span style="color:#0000ff;">(</span><span>date</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">let</span>&nbsp;<span style="color:#a0a000;">val</span>&nbsp;<span>months</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span style="color:#0000ff;">[</span><span style="color:#ff0000;">"January"</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">"February"</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">"March"</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">"April"</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">"May"</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">"June"</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">"July"</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">"August"</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">"September"</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">"October"</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">"November"</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">"December"</span><span style="color:#0000ff;">]</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">val</span>&nbsp;<span>day</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span style="color:#ff00ff;">Int</span><span style="color:#0000ff;">.</span><span>toString</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">#</span><span style="color:#ff0000;">1</span>&nbsp;<span>date</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">val</span>&nbsp;<span>month</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>get_nth</span><span style="color:#0000ff;">(</span><span>months</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">2</span>&nbsp;<span>date</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">val</span>&nbsp;<span>year</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span style="color:#ff00ff;">Int</span><span style="color:#0000ff;">.</span><span>toString</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span>date</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">in</span>&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">1</span>&nbsp;<span>date</span>&nbsp;<span style="color:#0000ff;"><</span>&nbsp;<span style="color:#ff0000;">10</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span>month</span>&nbsp;<span style="color:#0000ff;">^</span>&nbsp;<span style="color:#ff0000;">" 0"</span>&nbsp;<span style="color:#0000ff;">^</span>&nbsp;<span>day</span>&nbsp;<span style="color:#0000ff;">^</span>&nbsp;<span style="color:#ff0000;">", "</span>&nbsp;<span style="color:#0000ff;">^</span>&nbsp;<span>year</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>month</span>&nbsp;<span style="color:#0000ff;">^</span>&nbsp;<span style="color:#ff0000;">" "</span>&nbsp;<span style="color:#0000ff;">^</span>&nbsp;<span>day</span>&nbsp;<span style="color:#0000ff;">^</span>&nbsp;<span style="color:#ff0000;">", "</span>&nbsp;<span style="color:#0000ff;">^</span>&nbsp;<span>year</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">end</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>number_before_reaching</span>&nbsp;<span style="color:#0000ff;">(</span><span>target</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span><span style="color:#0000ff;">,</span>&nbsp;<span>int_list</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span>&nbsp;<span>list</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>target</span>&nbsp;<span style="color:#0000ff;">-</span>&nbsp;<span>hd</span>&nbsp;<span>int_list</span>&nbsp;<span style="color:#0000ff;">></span>&nbsp;<span style="color:#ff0000;">0</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#ff0000;">1</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span>number_before_reaching</span><span style="color:#0000ff;">(</span><span>target</span>&nbsp;<span style="color:#0000ff;">-</span>&nbsp;<span>hd</span>&nbsp;<span>int_list</span><span style="color:#0000ff;">,</span>&nbsp;<span>tl</span>&nbsp;<span>int_list</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span style="color:#ff0000;">1</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>what_month</span>&nbsp;<span style="color:#0000ff;">(</span><span>day</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">let</span>&nbsp;<span style="color:#a0a000;">val</span>&nbsp;<span>months</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span style="color:#0000ff;">[</span><span style="color:#ff0000;">31</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">28</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">31</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">31</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">31</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">31</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">31</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">31</span><span style="color:#0000ff;">]</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">in</span>&nbsp;<span>number_before_reaching</span><span style="color:#0000ff;">(</span><span>day</span><span style="color:#0000ff;">,</span>&nbsp;<span>months</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">end</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>month_range</span>&nbsp;<span style="color:#0000ff;">(</span><span>day1</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span><span style="color:#0000ff;">,</span>&nbsp;<span>day2</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">let</span>&nbsp;<span style="color:#a0a000;">fun</span>&nbsp;<span>count</span>&nbsp;<span style="color:#0000ff;">(</span><span>from</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span><span style="color:#0000ff;">,</span>&nbsp;<span>to</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>from</span>&nbsp;<span style="color:#0000ff;">></span>&nbsp;<span>to</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#0000ff;">[</span><span style="color:#0000ff;">]</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>from</span>&nbsp;<span style="color:#0000ff;">::</span>&nbsp;<span>count</span><span style="color:#0000ff;">(</span><span>from</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span>&nbsp;<span>to</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">val</span>&nbsp;<span>month1</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>what_month</span><span style="color:#0000ff;">(</span><span>day1</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">val</span>&nbsp;<span>month2</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>what_month</span><span style="color:#0000ff;">(</span><span>day2</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">in</span>&nbsp;<span>count</span><span style="color:#0000ff;">(</span><span>month1</span><span style="color:#0000ff;">,</span>&nbsp;<span>month2</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">end</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>oldest</span>&nbsp;<span style="color:#0000ff;">(</span><span>list_of_dates</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span>list</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">let</span>&nbsp;<span style="color:#a0a000;">val</span>&nbsp;<span>tail</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>tl</span>&nbsp;<span>list_of_dates</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">in</span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>null</span>&nbsp;<span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>tail</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#a0a000;">andalso</span>&nbsp;<span>is_older</span><span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>list_of_dates</span><span style="color:#0000ff;">,</span>&nbsp;<span>hd</span>&nbsp;<span>tail</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span>hd</span>&nbsp;<span>list_of_dates</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>null</span>&nbsp;<span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>tail</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span>hd</span>&nbsp;<span>tail</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>is_older</span><span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>list_of_dates</span><span style="color:#0000ff;">,</span>&nbsp;<span>hd</span>&nbsp;<span>tail</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span>oldest</span><span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>list_of_dates</span>&nbsp;<span style="color:#0000ff;">::</span>&nbsp;<span>tl</span>&nbsp;<span>tail</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>oldest</span><span style="color:#0000ff;">(</span><span>tail</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">end</span><br>
<br>
<span style="color:#00aaff;">(* Exercise 1 tests *)</span><br>
<br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result0</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>is_older</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2024</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* true *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result1</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>is_older</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* true *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result2</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>is_older</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#ff0000;">2</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* true *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result3</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>is_older</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* false *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result4</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>is_older</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2024</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* false *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result5</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>number_in_month</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">[</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">3</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2024</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">1</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* 2 *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result6</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>number_in_month</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">[</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">3</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2024</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">7</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* 0 *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result7</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>number_in_months</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">[</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">5</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">20</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#0000ff;">[</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">3</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* 3 *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result8</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>dates_in_month</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">[</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">5</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">20</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">2</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* [(1,2,2023),(20,2,2023)] *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result9</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>get_nth</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">[</span><span style="color:#ff0000;">"hello"</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">"ece"</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">"msfea"</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">"334"</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">3</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* "msfea" *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result10</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>date_to_string</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* "January 01, 2023" *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result11</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>date_to_string</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#ff0000;">10</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* "January 10, 2023" *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result12</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>number_before_reaching</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">7</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#0000ff;">[</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">3</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">10</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* 4 *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result13</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>what_month</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">89</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* 3 *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result14</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>month_range</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">330</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* [1,2,3,4,5,6,7,8,9,10,11] *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result15</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>oldest</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">[</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">5</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">20</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* (1,1,2023) *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result16</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>oldest</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">[</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2024</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2024</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">5</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">20</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">2023</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* (20,2,2023) *)</span><br>
<br>
<br>
<span style="color:#00aaff;">(* Exercise 2 *)</span><br>
<br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>invertRGBPixel</span>&nbsp;<span style="color:#0000ff;">(</span><span>rgb_pixel</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">(</span><span style="color:#ff0000;">255</span>&nbsp;<span style="color:#0000ff;">-</span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">1</span>&nbsp;<span>rgb_pixel</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">255</span>&nbsp;<span style="color:#0000ff;">-</span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">2</span>&nbsp;<span>rgb_pixel</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">255</span>&nbsp;<span style="color:#0000ff;">-</span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span>rgb_pixel</span><span style="color:#0000ff;">)</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>rgb2gray</span>&nbsp;<span style="color:#0000ff;">(</span><span>rgb_pixel</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">(</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">#</span><span style="color:#ff0000;">1</span>&nbsp;<span>rgb_pixel</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">*</span><span style="color:#ff0000;">3</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#0000ff;">#</span><span style="color:#ff0000;">2</span>&nbsp;<span>rgb_pixel</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">*</span><span style="color:#ff0000;">6</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span>rgb_pixel</span><span style="color:#0000ff;">)</span>&nbsp;<span>div</span>&nbsp;<span style="color:#ff0000;">10</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>gray2bw</span>&nbsp;<span style="color:#0000ff;">(</span><span>grayscale_pixel</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>grayscale_pixel</span>&nbsp;<span style="color:#0000ff;"><</span>&nbsp;<span style="color:#ff0000;">128</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#ff0000;">0</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span style="color:#ff0000;">255</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>isBrighter</span>&nbsp;<span style="color:#0000ff;">(</span><span>rgb_pixel1</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">,</span>&nbsp;<span>rgb_pixel2</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>rgb2gray</span><span style="color:#0000ff;">(</span><span>rgb_pixel1</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">></span>&nbsp;<span>rgb2gray</span><span style="color:#0000ff;">(</span><span>rgb_pixel2</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#ff0000;">true</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span style="color:#ff0000;">false</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>invertImage</span>&nbsp;<span style="color:#0000ff;">(</span><span>image</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span>list</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>null</span>&nbsp;<span>image</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#0000ff;">[</span><span style="color:#0000ff;">]</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>invertRGBPixel</span><span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>image</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">::</span>&nbsp;<span>invertImage</span><span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>image</span><span style="color:#0000ff;">)</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>rgb2grayImage</span>&nbsp;<span style="color:#0000ff;">(</span><span>image</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span>list</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>null</span>&nbsp;<span>image</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#0000ff;">[</span><span style="color:#0000ff;">]</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>rgb2gray</span><span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>image</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">::</span>&nbsp;<span>rgb2grayImage</span><span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>image</span><span style="color:#0000ff;">)</span><br>
<br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>getPixel</span>&nbsp;<span style="color:#0000ff;">(</span><span>image</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span>list</span><span style="color:#0000ff;">,</span>&nbsp;<span>i</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>i</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span style="color:#ff0000;">0</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span>hd</span>&nbsp;<span>image</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>getPixel</span><span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>image</span><span style="color:#0000ff;">,</span>&nbsp;<span>i</span>&nbsp;<span style="color:#0000ff;">-</span>&nbsp;<span style="color:#ff0000;">1</span><span style="color:#0000ff;">)</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>countRedPixels</span>&nbsp;<span style="color:#0000ff;">(</span><span>image</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span>list</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>null</span>&nbsp;<span>image</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#0000ff;">[</span><span style="color:#0000ff;">]</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">1</span>&nbsp;<span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>image</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">></span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">2</span>&nbsp;<span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>image</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#a0a000;">andalso</span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">1</span>&nbsp;<span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>image</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">></span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>image</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span>hd</span>&nbsp;<span>image</span>&nbsp;<span style="color:#0000ff;">::</span>&nbsp;<span>countRedPixels</span><span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>image</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>countRedPixels</span><span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>image</span><span style="color:#0000ff;">)</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>countRedPixels</span>&nbsp;<span style="color:#0000ff;">(</span><span>image</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">case</span>&nbsp;<span>image</span>&nbsp;<span style="color:#a0a000;">of</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">[</span><span style="color:#0000ff;">]</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span style="color:#0000ff;">[</span><span style="color:#0000ff;">]</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">|</span>&nbsp;<span>head</span>&nbsp;<span style="color:#0000ff;">::</span>&nbsp;<span>tail</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span style="color:#a0a000;">case</span>&nbsp;<span>head</span>&nbsp;<span style="color:#a0a000;">of</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">(</span><span>r</span><span style="color:#0000ff;">,</span>&nbsp;<span>g</span><span style="color:#0000ff;">,</span>&nbsp;<span>b</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>r</span>&nbsp;<span style="color:#0000ff;">></span>&nbsp;<span>g</span>&nbsp;<span style="color:#a0a000;">andalso</span>&nbsp;<span>r</span>&nbsp;<span style="color:#0000ff;">></span>&nbsp;<span>b</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span>head</span>&nbsp;<span style="color:#0000ff;">::</span>&nbsp;<span>countRedPixels</span><span style="color:#0000ff;">(</span><span>tail</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>countRedPixels</span><span style="color:#0000ff;">(</span><span>tail</span><span style="color:#0000ff;">)</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>getPixelsinBlueRange</span>&nbsp;<span style="color:#0000ff;">(</span><span>image</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span>list</span><span style="color:#0000ff;">,</span>&nbsp;<span>range</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span>list</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>null</span>&nbsp;<span>image</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#0000ff;">[</span><span style="color:#0000ff;">]</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>image</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">></span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>range</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#a0a000;">andalso</span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>image</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;"><</span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>range</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span>hd</span>&nbsp;<span>image</span>&nbsp;<span style="color:#0000ff;">::</span>&nbsp;<span>getPixelsinBlueRange</span><span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>image</span><span style="color:#0000ff;">,</span>&nbsp;<span>range</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>getPixelsinBlueRange</span><span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>image</span><span style="color:#0000ff;">,</span>&nbsp;<span>range</span><span style="color:#0000ff;">)</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>countBluePixelsInBlueRange</span>&nbsp;<span style="color:#0000ff;">(</span><span>image</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span>list</span><span style="color:#0000ff;">,</span>&nbsp;<span>range</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span>list</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>null</span>&nbsp;<span>image</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#ff0000;">0</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>image</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">></span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>range</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#a0a000;">andalso</span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>image</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;"><</span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>range</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#ff0000;">1</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span>countBluePixelsInBlueRange</span><span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>image</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>countBluePixelsInBlueRange</span><span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>image</span><span style="color:#0000ff;">)</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>countBluePixelsInBlueRange</span>&nbsp;<span style="color:#0000ff;">(</span><span>image</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span>list</span><span style="color:#0000ff;">,</span>&nbsp;<span>range</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span>list</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">let</span>&nbsp;<span style="color:#a0a000;">fun</span>&nbsp;<span>count</span>&nbsp;<span style="color:#0000ff;">(</span><span>image</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span>list</span><span style="color:#0000ff;">,</span>&nbsp;<span>range</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span>list</span><span style="color:#0000ff;">,</span>&nbsp;<span>acc</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>null</span>&nbsp;<span>image</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span>acc</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>image</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">></span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>range</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#a0a000;">andalso</span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>image</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;"><</span>&nbsp;<span style="color:#0000ff;">#</span><span style="color:#ff0000;">3</span>&nbsp;<span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>range</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span>countBluePixelsInBlueRange</span><span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>image</span><span style="color:#0000ff;">,</span>&nbsp;<span>acc</span><span style="color:#0000ff;">+</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>countBluePixelsInBlueRange</span><span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>image</span><span style="color:#0000ff;">,</span>&nbsp;<span>acc</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">in</span>&nbsp;<span>count</span>&nbsp;<span style="color:#0000ff;">(</span><span>image</span><span style="color:#0000ff;">,</span>&nbsp;<span>range</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">0</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">end</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>countBluePixelsInBlueRange</span>&nbsp;<span style="color:#0000ff;">(</span><span>image</span><span style="color:#0000ff;">,</span>&nbsp;<span>range</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">let</span>&nbsp;<span style="color:#a0a000;">fun</span>&nbsp;<span>count</span>&nbsp;<span style="color:#0000ff;">(</span><span>image</span><span style="color:#0000ff;">,</span>&nbsp;<span>range</span><span style="color:#0000ff;">,</span>&nbsp;<span>acc</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">case</span>&nbsp;<span>range</span>&nbsp;<span style="color:#a0a000;">of</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">[</span><span style="color:#0000ff;">]</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span>acc</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">|</span>&nbsp;<span style="color:#0000ff;">(</span><span>r</span><span style="color:#0000ff;">,</span>&nbsp;<span>g</span><span style="color:#0000ff;">,</span>&nbsp;<span>b</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">::</span>&nbsp;<span>tail</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span style="color:#a0a000;">case</span>&nbsp;<span>tail</span>&nbsp;<span style="color:#a0a000;">of</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">[</span><span style="color:#0000ff;">]</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span>acc</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">|</span>&nbsp;<span style="color:#0000ff;">(</span><span>r1</span><span style="color:#0000ff;">,</span>&nbsp;<span>g1</span><span style="color:#0000ff;">,</span>&nbsp;<span>g1</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">::</span>&nbsp;<span>tail1</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span style="color:#a0a000;">case</span>&nbsp;<span>image</span>&nbsp;<span style="color:#a0a000;">of</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">[</span><span style="color:#0000ff;">]</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span>acc</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">|</span>&nbsp;<span style="color:#0000ff;">(</span><span>r2</span><span style="color:#0000ff;">,</span>&nbsp;<span>g2</span><span style="color:#0000ff;">,</span>&nbsp;<span>b2</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">::</span>&nbsp;<span>tail2</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>r2</span>&nbsp;<span style="color:#0000ff;">></span>&nbsp;<span>r</span>&nbsp;<span style="color:#a0a000;">andalso</span>&nbsp;<span>r2</span>&nbsp;<span style="color:#0000ff;"><</span>&nbsp;<span>r1</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span>count</span>&nbsp;<span style="color:#0000ff;">(</span><span>tail2</span><span style="color:#0000ff;">,</span>&nbsp;<span>range</span><span style="color:#0000ff;">,</span>&nbsp;<span>acc</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span style="color:#ff0000;">1</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>count</span>&nbsp;<span style="color:#0000ff;">(</span><span>tail2</span><span style="color:#0000ff;">,</span>&nbsp;<span>range</span><span style="color:#0000ff;">,</span>&nbsp;<span>acc</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">in</span>&nbsp;<span>count</span>&nbsp;<span style="color:#0000ff;">(</span><span>image</span><span style="color:#0000ff;">,</span>&nbsp;<span>range</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">0</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">end</span><br>
<br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>brightest</span>&nbsp;<span style="color:#0000ff;">(</span><span>image</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span>list</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">let</span>&nbsp;<span style="color:#a0a000;">val</span>&nbsp;<span>tail</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>tl</span>&nbsp;<span>image</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">in</span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>null</span>&nbsp;<span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>tail</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#a0a000;">andalso</span>&nbsp;<span>isBrighter</span><span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>image</span><span style="color:#0000ff;">,</span>&nbsp;<span>hd</span>&nbsp;<span>tail</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span>hd</span>&nbsp;<span>image</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>null</span>&nbsp;<span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>tail</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span>hd</span>&nbsp;<span>tail</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>isBrighter</span><span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>image</span><span style="color:#0000ff;">,</span>&nbsp;<span>hd</span>&nbsp;<span>tail</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span>brightest</span><span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>image</span>&nbsp;<span style="color:#0000ff;">::</span>&nbsp;<span>tl</span>&nbsp;<span>tail</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>brightest</span><span style="color:#0000ff;">(</span><span>tail</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">end</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>countWhite</span>&nbsp;<span style="color:#0000ff;">(</span><span>image_list</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">*</span><span style="color:#00c000;">int</span><span style="color:#0000ff;">)</span>&nbsp;<span>list</span>&nbsp;<span>list</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>null</span>&nbsp;<span>image_list</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#ff0000;">0</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>rgb2gray</span><span style="color:#0000ff;">(</span><span>brightest</span><span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>image_list</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span style="color:#ff0000;">255</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#ff0000;">1</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span>countWhite</span><span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>image_list</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>countWhite</span><span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>image_list</span><span style="color:#0000ff;">)</span><br>
<br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>shrinkImage</span>&nbsp;<span style="color:#0000ff;">(</span><span>grayscale_image</span><span style="color:#0000ff;">:</span>&nbsp;<span style="color:#00c000;">int</span>&nbsp;<span>list</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>null</span>&nbsp;<span>grayscale_image</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#0000ff;">[</span><span style="color:#0000ff;">]</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#0000ff;">(</span><span>hd</span>&nbsp;<span>grayscale_image</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span>hd</span>&nbsp;<span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>grayscale_image</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span>&nbsp;<span>div</span>&nbsp;<span style="color:#ff0000;">2</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">::</span>&nbsp;<span>shrinkImage</span><span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span style="color:#0000ff;">(</span><span>tl</span>&nbsp;<span>grayscale_image</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><br>
<br>
<span style="color:#00aaff;">(* Exercise 2 tests *)</span><br>
<br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result17</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>invertRGBPixel</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* (225,225,225) *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result18</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>rgb2gray</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* 30 *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result19</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>rgb2gray</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">31</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* 30 *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result20</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>gray2bw</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">120</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* 0 *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result21</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>gray2bw</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">200</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* 255 *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result22</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>isBrighter</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">20</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* true *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result23</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>isBrighter</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">40</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* false *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result24</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>invertImage</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">[</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">40</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">20</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">20</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* [(225,225,225),(215,225,225),(235,235,225)] *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result25</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>rgb2grayImage</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">[</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">40</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">20</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">20</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* [30,33,21] *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result26</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>brightest</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">[</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">40</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">20</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">20</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* (40,30,30) *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result27</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>countWhite</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">[</span><span style="color:#0000ff;">[</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">40</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">20</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">20</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">[</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">255</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">255</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">255</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">20</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">20</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">[</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">40</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">255</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">255</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">255</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* 2 *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result28</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>shrinkImage</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">[</span><span style="color:#ff0000;">30</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">10</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">80</span><span style="color:#0000ff;">,</span><span style="color:#ff0000;">60</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#00aaff;">(* [20,70] *)</span><br>
<br>
</body>
</html></tt>
